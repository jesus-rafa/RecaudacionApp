{% extends 'base_new.html' %}
{% load static %}
{% load tags %}

{% block title %} Consulta {% endblock title %}


{% block content %}
<div class="row">
    <div class="col-12">
        <div class="page-title-box">
            <div class="page-title-right">
            </div>
            <h4 class="page-title">Consulta</h4>  
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xl-8 mb-30">
        <div class="card">
            <div class="card-body">

                <form method="GET">
                    <div class="input-group">

                        <span class="input-group-text">Contribuyente</span>
                        <input type="text" class="form-control" id="kword" name="kword" placeholder="RFC o Nombre...">

                        <button type="submit" class="btn btn-primary btn" target="_blank" value="Buscar"> <i
                                class="fa fa-search"></i> Buscar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xl-12 mb-30">
        <div class="card">
            <div class="card-body">
                {% if paramertro %}
                    <div class="table-responsive">
                        <table id="table" class="table table-striped table-bordered p-0">
                            <thead>
                                <tr>
                                    <th>RFC</th>
                                    <th>Nombre</th>
                                    <th>Direccion</th>
                                    <th>Estatus</th>
                                    <th>Programas</th> 
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    {% for rec in contribuyentes %}
                                    <td>{{ rec.rfc }}</td>
                                    <td>{{ rec.nombre }}</td>
                                    <td>{{ rec.direccion }}</td>
                                    {% empty %}
                                        {% if det1 %}
                                            {% for detalle in det1 %}
                                            <td>{{ detalle.rfc }}</td>
                                            <td>{{ detalle.nombre }}</td>
                                            <td>{{ detalle.direccion }}</td>
                                            {% endfor %}
                                        {% else %}
                                            {% if det2 %}
                                                {% for detalle in det2 %}
                                                <td>{{ detalle.rfc }}</td>
                                                <td>{{ detalle.nombre }}</td>
                                                <td>{{ detalle.direccion }}</td>
                                                {% endfor %}
                                            {% else %}
                                                {% if det3 %}
                                                    {% for detalle in det3 %}
                                                    <td>{{ detalle.rfc }}</td>
                                                    <td>{{ detalle.nombre }}</td>
                                                    <td>{{ detalle.direccion }}</td>
                                                    {% endfor %}
                                                {% else %}
                                                    {% if det4 %}
                                                        {% for detalle in det4 %}
                                                        <td>{{ detalle.rfc }}</td>
                                                        <td>{{ detalle.nombre }}</td>
                                                        <td>{{ detalle.direccion }}</td>
                                                        {% endfor %}
                                                    {% else %}
                                                        {% if det5 %}
                                                            {% for detalle in det5 %}
                                                            <td>{{ detalle.rfc }}</td>
                                                            <td>{{ detalle.nombre }}</td>
                                                            <td>{{ detalle.direccion }}</td>
                                                            {% endfor %}
                                                        {% endif %}
                                                    {% endif %}
                                                {% endif %}
                                            {% endif %}
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                        <h5>
                                    {% if det1 or det2 or det3 or det4%}
                                        <div class="text-center">
                                            <span class="badge bg-success">ACTIVO</span>
                                        </div>
                                    {% endif %}
                                    
                                    {% for detalle in det5 %}
                                            <span class="badge bg-success">EN TRANSFERENCIA / {{ detalle.nuevo_folio }}</span> 
                                        {% endfor %}
                                    </h5>
                                    </td>
                                    <td>
                                        <h5>
                                        {% for detalle in det1 %}
                                            <span class="badge bg-primary">{{ detalle.programa }} / RECAUDACION</span>
                                        {% endfor %}
                                        {% for detalle in det2 %}
                                            <span class="badge bg-primary">{{ detalle.programa }} / RECAUDACION</span> 
                                        {% endfor %}
                                        {% for detalle in det3 %}
                                            <span class="badge bg-primary">{{ detalle.programa }} / AUDITORIA</span>
                                        {% endfor %}
                                        {% for detalle in det4 %}
                                            <span class="badge bg-primary">{{ detalle.programa }} / EJECUCION</span> 
                                        {% endfor %}
                                        </h5>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <div class="alert alert-warning alert-dismissible fade show" role="alert">
                        Ingrese el RFC o nombre del contribuyente a buscar...
                        </button>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock content %}
